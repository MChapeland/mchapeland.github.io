<!DOCTYPE html>
<html>
<head>

    <!-- Title of the page -->
    <title>Curiosity World Map</title>

    <!-- Page Setup -->
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=2.0" />
    <meta http-equiv="X-UA-Compatible" content="ie-edge" />

    <!-- Index Scripts -->
    <link tag="indexCSS" rel="stylesheet" type="text/css" href="index.css" />

    <!-- Leaflet Scripts -->
    <link tag="leafletCSS" rel="stylesheet" href="scripts/leaflet.css" />
    <script tag="leafletJS" src="scripts/leaflet.js"></script>

</head>



<body>

    <div class="header">
        <label>CURIOSITY MAP</label>
    </div>

    <input type="checkbox" class="openSidebarMenu" id="openSidebarMenu">

    <label for="openSidebarMenu" class="sidebarIconToggle">
        <div class="spinner diagonal part-1"></div>
        <div class="spinner horizontal"></div>
        <div class="spinner diagonal part-2"></div>
    </label>

    <div id="sidebarMenu">
    </div>

    <div class="main">

        <div id="map"></div>
         


    </div>


    <script>

        var map = L.map('map').setView([-40, 0], 2);

        var tiles = L.tileLayer('map/{z}/{x}/{y}.png', {
            continuousWorld: false,
            noWrap: true,
            minZoom: 2,
            maxZoom: 5,
        }).addTo(map);

        var BaseIcon = L.Icon.extend({
            options: {
                shadowUrl: 'img/marker-shadow.png',
                iconSize: [30], // size of the icon
                shadowSize: [50, 64], // size of the shadow
                iconAnchor: [3, 48], // point of the icon which will correspond to marker's location
                shadowAnchor: [4, 62],  // the same for the shadow
                popupAnchor: [11, -50] // point from which the popup should open relative to the iconAnchor
            }

        });

        var greenM = new BaseIcon({ iconUrl: 'img/marker-icon-green.svg' });
        var redM = new BaseIcon({ iconUrl: 'img/marker-icon-red.svg' });
        var orangeM = new BaseIcon({ iconUrl: 'img/marker-icon-orange.svg' });
        var blackM = new BaseIcon({ iconUrl: 'img/marker-icon-black.svg' });
        var purpleM = new BaseIcon({ iconUrl: 'img/marker-icon-purple.svg' });
        var blueM = new BaseIcon({ iconUrl: 'img/marker-icon-blue.svg' });

        var marker = L.marker([51.5, -0.09], { icon:redM }).addTo(map)
            .bindPopup('<b>Hello world!</b><br />I am a popup.').openPopup();

        getData();

        async function getData() {
            const response = await fetch("data.csv");;
            const data = await response.text();

            const table = data.split('\n').slice(1);
            table.forEach(row => {
                const column = row.split(',');
                const name = column[0];
                const posX = Number(column[1]);
                const posY = Number(column[2]);
                const layer = column[3];
                const type = column[4];
                const desc = column[5];

                marker = L.marker([posX, posY], { type }).addTo(map)
                    .bindPopup(desc);

                console.log(color);

            });

        }


    </script>
</body>
</html>