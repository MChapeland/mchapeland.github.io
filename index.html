<!DOCTYPE html>
<html>
<head>

    <!-- Title of the page -->
    <title>Project World Map</title>

    <!-- Page Setup -->
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=2.0" />
    <meta http-equiv="X-UA-Compatible" content="ie-edge" />

    <!-- Index Scripts -->
    <link tag="indexCSS" rel="stylesheet" type="text/css" href="index.css" />

    <!-- Leaflet Scripts -->
    <link tag="leafletCSS" rel="stylesheet" href="scripts/leaflet.css" />
    <script tag="leafletJS" src="scripts/leaflet.js"></script>

</head>


<body>

    <div class="header">
        <label>PROJECT MAP</label>
    </div>

    <input type="checkbox" class="openSidebarMenu" id="openSidebarMenu">

    <label for="openSidebarMenu" class="sidebarIconToggle">
        <div class="spinner diagonal part-1"></div>
        <div class="spinner horizontal"></div>
        <div class="spinner diagonal part-2"></div>
    </label>

    <div id="sidebarMenu">
    </div>

    <div class="main">

        <div id="map"></div>
         


    </div>


    <script>

        var map = L.map('map').setView([-40, 0], 2);

        var tiles = L.tileLayer('map/{z}/{x}/{y}.png', {
            continuousWorld: false,
            noWrap: true,
            minZoom: 2,
            maxZoom: 4,
        }).addTo(map);

        var BaseIcon = L.Icon.extend({
            options: {
                shadowUrl: 'img/marker-shadow.png',
                iconSize: [30], // size of the icon
                shadowSize: [50, 64], // size of the shadow
                iconAnchor: [3, 48], // point of the icon which will correspond to marker's location
                shadowAnchor: [3, 63],  // the same for the shadow
                popupAnchor: [11, -50] // point from which the popup should open relative to the iconAnchor
            }

        });

        var redM = new BaseIcon({ iconUrl: 'img/marker-icon-red.svg' });
        var orangeM = new BaseIcon({ iconUrl: 'img/marker-icon-orange.svg' });
        var yellowM = new BaseIcon({ iconUrl: 'img/marker-icon-yellow.svg' });
        var greenM = new BaseIcon({ iconUrl: 'img/marker-icon-green.svg' });
        var tealM = new BaseIcon({ iconUrl: 'img/marker-icon-teal.svg' });
        var cyanM = new BaseIcon({ iconUrl: 'img/marker-icon-cyan.svg' });
        var blueM = new BaseIcon({ iconUrl: 'img/marker-icon-blue.svg' });
        var purpleM = new BaseIcon({ iconUrl: 'img/marker-icon-purple.svg' });
        var pinkM = new BaseIcon({ iconUrl: 'img/marker-icon-pink.svg' });
        var whiteM = new BaseIcon({ iconUrl: 'img/marker-icon-white.svg' });
        var greyM = new BaseIcon({ iconUrl: 'img/marker-icon-grey.svg' });
        var blackM = new BaseIcon({ iconUrl: 'img/marker-icon-black.svg' });

        var marker = L.marker([60, -110], { icon: redM }).addTo(map)
            .bindPopup('<b>Red Markers</b>');

        var marker = L.marker([60, -100], { icon: orangeM }).addTo(map)
            .bindPopup('<b>Orange Markers</b>');

        var marker = L.marker([60, -90], { icon: yellowM }).addTo(map)
            .bindPopup('<b>Yellow Markers</b>');

        var marker = L.marker([60, -80], { icon: greenM }).addTo(map)
            .bindPopup('<b>Green Markers</b>');

        var marker = L.marker([60, -70], { icon: tealM }).addTo(map)
            .bindPopup('<b>Teal Markers</b>');

        var marker = L.marker([60, -60], { icon: cyanM }).addTo(map)
            .bindPopup('<b>Cyan Markers</b>');

        var marker = L.marker([60, -50], { icon: blueM }).addTo(map)
            .bindPopup('<b>Blue Markers</b>');

        var marker = L.marker([60, -40], { icon: purpleM }).addTo(map)
            .bindPopup('<b>Purple Markers</b>');

        var marker = L.marker([60, -30], { icon: pinkM }).addTo(map)
            .bindPopup('<b>Pink Markers</b>');

        var marker = L.marker([60, -20], { icon: whiteM }).addTo(map)
            .bindPopup('<b>White Markers</b>');

        var marker = L.marker([60, -10], { icon: greyM }).addTo(map)
            .bindPopup('<b>Grey Markers</b>');

        var marker = L.marker([60, 0], { icon: blackM }).addTo(map)
            .bindPopup('<b>Black Markers</b>');

                /*
        getData();

        async function getData() {
            const response = await fetch('data.csv');
            const data = await response.text();

            const table = data.split('\n').slice(1);
            table.forEach(row => {
                const column = row.split(',');
                const name = column[0];
                const posY = column[1];
                const posX = column[2];
                const layer = column[3];
                const color = column[4];
                const symbol = column[5];
                const desc = column[6];


                marker = L.marker([Number(posY), Number(posX)], { icon:color }).addTo(map)
                    .bindPopup(`<b>${name}</b><br />${desc}`);

                /*
                switch (color) {

                    case green:
                        marker = L.marker([Number(posX), Number(posY)], { icon:greenM }).addTo(map)
                            .bindPopup(desc);
                    break;


                    case red:
                        marker = L.marker([Number(posX), Number(posY)], { icon:redM }).addTo(map)
                            .bindPopup(desc);
                    break;


                    case orange:
                        marker = L.marker([Number(posX), Number(posY)], { icon:orangeM }).addTo(map)
                            .bindPopup(desc);
                    break;


                    case black:
                        marker = L.marker([Number(posX), Number(posY)], { icon:blackM }).addTo(map)
                            .bindPopup(desc);
                    break;


                    case purple:
                        marker = L.marker([Number(posX), Number(posY)], { icon:purpleM }).addTo(map)
                            .bindPopup(desc);
                    break;


                    case blue:
                        marker = L.marker([Number(posX), Number(posY)], { icon:blueM }).addTo(map)
                            .bindPopup(desc);
                    break;

                    default:
                    break;
                }
            });
        }

                */



        const sheetID = '1lB1RY3fwmw9k0t_M4vQt6z__ieHWX7frPUhjbey-9S0';
        const base = 'https://docs.google.com/spreadsheets/d/1lB1RY3fwmw9k0t_M4vQt6z__ieHWX7frPUhjbey-9S0/gviz/tq?';

        const sheetName = 'users';

        const query = encodeURIComponent('Select *');

        const url = `${base}&sheet=${sheetName}&tq=${query}`;

        const sheetData = [];

        document.addEventListener('DOMContentLoaded', sheet2JS);

        function sheet2JS() {
            fetch(url)
                .then(res => res.text())
                .then(rep => {

                    const refinedData = JSON.parse(rep.substr(47).slice(0, -2));

                    refinedData.table.rows.forEach((main) => {

                        console.log(main);
                        const group = Object.values(main);
                        const blocks = group.split(',');
                        const name = blocks[3];
                        const y = blocks[3];
                        const x = blocks[3];
                        const layer = blocks[3];
                        const color = blocks[3];
                        const symbol = blocks[3];
                        const desc = blocks[3];

                        console.log(name);
                        console.log(y);
                        console.log(x);
                        console.log(layer);
                        console.log(symbol);
                        console.log(desc);

                        marker = L.marker([Number(y), Number(x)]).addTo(map)
                            .bindPopup(`<b>${name}</b><br />${desc}`);

                    });

                });
        }

            /*
            switch (color) {
 
                case green:
                    marker = L.marker([Number(posX), Number(posY)], { icon:greenM }).addTo(map)
                        .bindPopup(desc);
                break;
 
 
                case red:
                    marker = L.marker([Number(posX), Number(posY)], { icon:redM }).addTo(map)
                        .bindPopup(desc);
                break;
 
 
                case orange:
                    marker = L.marker([Number(posX), Number(posY)], { icon:orangeM }).addTo(map)
                        .bindPopup(desc);
                break;
 
 
                case black:
                    marker = L.marker([Number(posX), Number(posY)], { icon:blackM }).addTo(map)
                        .bindPopup(desc);
                break;
 
 
                case purple:
                    marker = L.marker([Number(posX), Number(posY)], { icon:purpleM }).addTo(map)
                        .bindPopup(desc);
                break;
 
 
                case blue:
                    marker = L.marker([Number(posX), Number(posY)], { icon:blueM }).addTo(map)
                        .bindPopup(desc);
                break;
 
                default:
                break;
            }
            */

    </script>
</body>
</html>